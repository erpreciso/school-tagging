{% extends "backbone.html" %}

{% block title %}
school-tagging application
{% endblock %}

{% block wrapper %}
<div id="wrapper">
	<header>
		<div id="title">
			<h1><a href="/welcome">School Tagging application</a></h1>
		</div>
		<div id="login_tools">
			<a href="/login">Login</a>
			|
			<a href="/signup">Signup</a>
			|
			<a href="/logout">Logout</a>
		</div>
	</header>
	<h3>Welcome! {{username}}</h3>
	{% block payload %}
<!--
	student's payload here...
-->
	{% endblock %}
	<div id="message_board">
		<h4>Message Board</h4>
		<form method="POST">
			<label>Send message --> </label>
			<input type="text" name="message">
			<input type="submit" value="GO!">
		</form>
		<h4>Message History</h4>
		<div id="all_messages">
		{% for message in messages %}
			<div class="msg">
				{{message["timestamp"]}} 
				| {{message["username"]}} 
				| <strong>{{message["message"]}}</strong>
			</div>
		{% endfor %}
	</div>
	</div>
	<footer>
		<div id="userlist">
			<p>Who's logged in</p>
		{% for user in logged %}
			<div class="user" id="{{user[1]}}">
				<div><strong>{{user[0]}}</strong></div>
				<div>{{user[1]}}</div>
			</div>
		{% endfor %}
		</div>
	</footer>
</div>
<!--
	javascript code for the Channel API
-->
<script>
	channel = new goog.appengine.Channel('{{token}}');
	socket = channel.open();
	socket.onopen = onOpened;
	socket.onmessage = onMessage;
	socket.onerror = function(){};
	socket.onclose = onClose;
</script>
{% endblock %}
