{% extends "backbone.html" %}

{% block title %}
school-tagging application
{% endblock %}

{% block wrapper %}
<div id="wrapper">
	<header>
		<div id="title">
			<h1><a href="/welcome">School Tagging application</a></h1>
		</div>
		<div id="login_tools">
			<a href="/login">Login</a>
			|
			<a href="/signup">Signup</a>
			|
			<a href="/logout">Logout</a>
		</div>
	</header>
	<div id="welcome">Welcome {{username}}</div>
	{% block payload %}
<!--
	student's payload here...
-->
	{% endblock %}
	<footer>
		<div id="message_board">
			<h2>Message Board</h2>
			<input type="text" name="message" placeholder="type message">
			<button id="send_message">Send message</button>
			<button id="clear_messages">Clear history</button>
			<h2>Message History</h2>
			<div id="all_messages">
			{% for message in messages %}
				<div class="msg">
					{{message["timestamp"]}} 
					| {{message["username"]}} 
					| <strong>{{message["message"]}}</strong>
				</div>
			{% endfor %}
			</div>
		</div>
		<div id="userlist">
			<div>Who's logged in</div>
		{% for user in logged %}
			<div class="user" id="{{user[1]}}">
				<div><strong>{{user[0]}}</strong></div>
				<div>{{user[1]}}</div>
			</div>
		{% endfor %}
		</div>
	</footer>
</div>
<!--
	javascript code for the Channel API
-->
<script>
	channel = new goog.appengine.Channel('{{token}}');
	socket = channel.open();
	socket.onopen = onOpened;
	socket.onmessage = onMessage;
	socket.onerror = function(){};
	socket.onclose = onClose;
</script>
{% endblock %}
